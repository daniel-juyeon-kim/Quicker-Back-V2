## Quicker Back V2

[졸업작품(Quicker)](https://github.com/daniel-juyeon-kim/Quicker_reactJS)의 문제점을 개선한 프로젝트입니다. [테스트 코드 작성](#테스트-코드-작성), [CI/CD 파이프라인 구축](#cicd-파이프라인-구축), [리팩토링, 재설계](#리팩토링-재설계)등의 작업을 수행하여 테스트 커버리지 95.52% 달성, 배포 자동화, LLM 코드리뷰등의 성과가 있었습니다.

### [테스트 코드 작성](https://github.com/daniel-juyeon-kim/Quicker-Back-V2/blob/main/docs/테스트%20코드%20작성.md)

#### [문제]

이전 프로젝트에서 개발자가 직접 테스트하면서 기능을 개발했습니다. 서버 프로젝트 전체를 리팩토링하면서 아래와 같은 문제를 겪어서 테스트 코드를 작성하려 했습니다. 하지만 데이터베이스 등 외부 환경 문제로 테스트 코드 작성하지 못하고 프로젝트가 마무리되었습니다.

- 리팩토링 후 같은 동작을 하는지 의심됨
- 개발자가 직접 하는 테스트는 일시적이고 오래 걸림
- 배포 후 놓친 엣지 케이스가 나옴

#### [해결]

모킹과 인 메모리 DB를 최소한으로 사용해 테스트 코드를 작성했고 테스트 커버리지 95.52%를 달성했습니다.

- 구현, 리팩토링 후 개발자가 의도한 동작을 보장함
- 지속적이고 빠른 테스트로 개발에 더 집중할 수 있음
- 엣지 케이스가 누락될 확률이 줄어듦

### [CI/CD 파이프라인 구축](https://github.com/daniel-juyeon-kim/Quicker-Back-V2/blob/main/docs/Github%20Action%EC%9D%84%20%ED%86%B5%ED%95%9C%20CI%20CD%20%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8%20%EA%B5%AC%EC%B6%95.md)

#### [문제]

이전 프로젝트에서 서버 개발과 관리를 담당했습니다. 기획 변경으로 서버에 다른 팀원의 기능을 이식하면서 배포가 2배로 늘고 개발하는 시간이 적어졌습니다. 그 외에도 불편한 점이 있었고 정리하면 아래와 같습니다.

- 서버에 PR 병합이 많아지면 개발시간이 줄고 배포는 늦어짐
- 팀원 중 코드 리뷰가 가능할 정도의 실력 차이가 없음
- 로컬 환경에서 통과한 테스트가 배포 환경에서는 실패할 수 있음(주로 코드 누락이 원인)

#### [해결]

CI/CD 툴 중에서 적은 학습으로 빠르게 사용할 수 있는 Github Action으로 파이프라인을 구축해 배포, 테스트, 코드 리뷰를 자동화했습니다. 아래와 같은 흐름으로 배포가 됩니다.

![CI/CD 파이프라인 이미지](https://raw.githubusercontent.com/daniel-juyeon-kim/Quicker-Back-V2/a8bc0e1c981ac7e8108e354f4a58ec4b102de5f5/docs/cicd-flow.drawio.svg)

- 배포 자동화로 서버 개발자가 배포에 소모하는 시간 단축(5분 -> 0분)
- LLM을 통한 코드 리뷰로 코드 퀄리티 향상
- 배포 환경에서 문제 발생 감소(코드 누락 감소)

### [리팩토링, 재설계](https://github.com/daniel-juyeon-kim/Quicker-Back-V2/blob/main/docs/%EB%A6%AC%ED%8C%A9%ED%86%A0%EB%A7%81%EA%B3%BC%20%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4%20%EC%84%A4%EA%B3%84.md)

#### [문제]

이전 프로젝트에서 설계가 부실해서 여러 책임이 파일 하나에 모여있었고 관리, 파악, 테스트가 어려웠습니다.

#### [해결]

객체 지향 프로그래밍을 통해 재설계, 리팩토링하여 관리, 파악, 테스트가 쉽도록 수정했습니다.

```md
외부로 노출되는 인터페이스는 최대한 작게, 하나의 클래스가 하나의 책임만 가지고 하나의 메서드는 하나의 동작만 수행합니다.

1. 어떤 일을 해야 하는지 작성합니다. (요구사항 명세)
2. 어떤 기능이 필요한지 나열합니다.
3. 어떤 클래스가 어떤 기능을 가져야 하는지 생각합니다. (클래스에 책임 할당)
4. 클래스에 필요한 속성을 생각합니다.
```

### Sequelize에서 TypeORM으로 마이그레이션

#### [문제]

이전 프로젝트에서 DB 작업을 하면서 아래와 같은 문제가 있었습니다.

- 트랜잭션 미적용으로 독립성에 문제 발생
- 레포지토리 계층에서 에러 핸들링 부족
- DB 설계 결함과 불필요한 테이블 존재

Sequelize를 하면서 아래와 같은 문제가 있었습니다.

- 모델(DB 테이블 매핑)과 모델을 이용한 DB 작업에 작성하는 코드양이 많음
- 위 문제로 DB를 만들고 [Sequelize-Auto](https://www.npmjs.com/package/sequelize-auto)로 모델을 동기화했으나 ORM에 대한 이해와 학습이 되지 않았음

#### [해결]

TypeScript를 지원하는 ORM 중 다운로드, 러닝 커브, 데코레이터 지원으로 TypeORM을 선택했습니다. [테스트](https://github.com/daniel-juyeon-kim/study-typeorm)를 통해 TypeORM의 사용법을 학습했습니다.

- 트랜잭션 적용으로 독립성 문제 해결
- 레포지토리 계층 에러를 만들고 에러 컨트롤러가 처리할 수 있도록 수정
- DB 재설계

### Docker 도입

요금 문제로 AWS, GCP를 번갈아 가면서 이용했습니다. 그때마다 서버 설정부터 배포까지 시간이 많이 소요되어서 도커를 도입해 서버 초기 설정 시간을 30분에서 10분으로 단축했습니다.

### Swagger로 API 문서 작성

이전 프로젝트에서 클라이언트와 서버를 연동하면서 서버 API 문서를 작성하지 않았습니다. 나중에 서버의 API 일부 기능을 까먹는 일이 발생했고 API 설계 문제도 있어서 재설계를 하면서 Swagger로 API 문서를 작성했습니다.

### 기타

- ESLint, Prettier를 이용한 코드 포맷팅
- 요청 데이터에 대한 유효성 검사
- 본문에 HTTP 응답 코드, 메시지를 본문에 같이 보냄
